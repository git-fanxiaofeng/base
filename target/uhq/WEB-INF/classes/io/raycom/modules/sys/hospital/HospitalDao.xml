<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="io.raycom.modules.sys.hospital.HospitalDao">
	
	<!-- 获取所有医院信息 -->
	<select id="queryHospitalList" resultType="rdata" parameterType="page">
	    SELECT  rownum       		"num",
	    		org_name 		   "orgName",
			 	org_id			   "orgId",
			 	tel		 	       "tel",
			 	contact  		   "contact",
			 	fax 			   "fax",
			 	address  		   "address",
			    postcode 		   "postcode",
			    email 			   "email",
			    website  		   "website"
		  FROM  tb_ups_hospital
       	 WHERE  del_flag='N' 
        <if test="param.orgName != null and param.orgName != ''">
		 	AND org_name like  '%' || trim(#{param.orgName}) || '%'
		</if>
  	    <if test="param.orgId != null and param.orgId != ''">
		 	AND org_id like  '%' || trim(#{param.orgId}) || '%'
		</if>
	  	  ORDER BY  org_id
	</select>	
	
	<!-- 新增医院 -->
	<insert id="createHospital" parameterType="rdata">
		INSERT  INTO tb_ups_hospital(
			    org_name,
			    org_id,
			    tel,
			    contact,
			    fax,
			    address,
			    postcode,
			    email,
			    website,
			    create_by,
				create_date,
				update_by,
				update_date,
			    remarks)
		VALUES (trim(#{orgName}),
			    SEQ_UPS_HOSPITAL.nextval,
			    trim(#{tel}),
			    trim(#{contact}),
			    trim(#{fax}),
			    trim(#{address}),
			    trim(#{postcode}),
			    trim(#{email}),
			    trim(#{website}),
			    #{currentUser},
				sysdate,
				#{currentUser},
				sysdate,
			    trim(#{remarks}))
	 </insert> 
	 
	<!-- 查询选中医院信息 -->
	<select id="queryHospitalDetail" resultType="rdata" parameterType="page">
	    SELECT  org_name 		"orgName",
			    org_id			"orgId",
			    tel				"tel",
			    contact 		"contact",
			    fax 			"fax",
			    address		    "address",
			    postcode		"postcode",
			    email			"email",
			    website			"website",
			    remarks		    "remarks"
          FROM  tb_ups_hospital
         WHERE  org_id=#{orgId}
	</select>	
	
	<!-- 更新医院基本信息 -->
	<update id="updateHospital" parameterType="rdata">
		UPDATE 	tb_ups_hospital
		   SET  org_name        = #{orgName}, 
                org_id			= #{orgId},
                tel				= #{tel},
                contact			= #{contact},
                fax				= #{fax},
                address			= #{address},
                postcode		= #{postcode},
                email			= #{email},
                website			= #{website},
				update_by  		= #{currentUser},
			    update_date 	= sysdate,
                remarks			= #{remarks}
		 WHERE  org_id			= #{orgId}
	</update>
</mapper>